import{d as T,c as w,w as m,f as n,a as $,u as C,h as j,o,b as s,e as l,x as N,q as V,F as B,t as L,r as z,T as M,l as R,m as q}from"./app-BTVi4zqZ.js";import{_ as F}from"./PublicLayout.vue_vue_type_script_setup_true_lang-ulzpU09i.js";const H={class:"mx-auto max-w-3xl px-4 py-12 sm:px-6 lg:px-8"},S=["content"],U=["href"],D=["content"],E=["content"],I=["content"],P=["content"],_={class:"mt-4 block text-sm text-gray-500 dark:text-gray-400"},A={class:"mt-2 text-3xl font-bold text-gray-900 dark:text-white"},G=["src","alt"],J=["innerHTML"],K={key:1,class:"mt-10"},O={class:"grid grid-cols-2 sm:grid-cols-3 gap-3"},Q=["onClick"],W=["src","alt"],X={key:2,class:"mt-10"},Y={class:"aspect-video w-full overflow-hidden rounded-lg bg-black"},Z=["src"],tt={key:3,class:"mt-10"},et={class:"overflow-hidden rounded-lg bg-black"},ot=["src"],st=["src"],nt={key:1,class:"mt-8 text-gray-500 dark:text-gray-400"},it=T({__name:"Show",props:{id:{},post:{},canLogin:{type:Boolean},canRegister:{type:Boolean}},setup(t){const g=a=>{if(!a)return"";try{const e=new URL(a);if(e.hostname.includes("youtube.com")||e.hostname.includes("youtu.be")){const i=e.hostname==="youtu.be"?e.pathname.slice(1):e.searchParams.get("v");return i?`https://www.youtube.com/embed/${i}`:a}if(e.hostname.includes("vk.com")&&e.pathname.includes("video")){const i=a.match(/video(-?\d+)_(\d+)/);return i?`https://vk.com/video_ext.php?oid=${i[1]}&id=${i[2]}&hd=2`:a}return a}catch{return a}},c=q(null);return(a,e)=>(o(),w(F,{title:"Новость","can-login":t.canLogin,"can-register":t.canRegister},{default:m(()=>{var i,h,y;return[n("div",H,[$(C(j),{title:((i=t.post)==null?void 0:i.meta_title)??((h=t.post)==null?void 0:h.title)??"Новость"},{default:m(()=>{var r,d,u,f,x,b,k,v,p;return[(r=t.post)!=null&&r.meta_description?(o(),s("meta",{key:0,name:"description",content:t.post.meta_description},null,8,S)):l("",!0),(d=t.post)!=null&&d.canonical_url?(o(),s("link",{key:1,rel:"canonical",href:t.post.canonical_url},null,8,U)):l("",!0),((u=t.post)==null?void 0:u.meta_title)??((f=t.post)==null?void 0:f.title)?(o(),s("meta",{key:2,property:"og:title",content:((x=t.post)==null?void 0:x.meta_title)??((b=t.post)==null?void 0:b.title)??"Новость"},null,8,D)):l("",!0),(k=t.post)!=null&&k.meta_description?(o(),s("meta",{key:3,property:"og:description",content:t.post.meta_description},null,8,E)):l("",!0),(v=t.post)!=null&&v.og_image?(o(),s("meta",{key:4,property:"og:image",content:t.post.og_image},null,8,I)):l("",!0),(p=t.post)!=null&&p.canonical_url?(o(),s("meta",{key:5,property:"og:url",content:t.post.canonical_url},null,8,P)):l("",!0),e[2]||(e[2]=n("meta",{property:"og:type",content:"article"},null,-1))]}),_:1},8,["title"]),$(C(N),{href:a.route("news.index"),class:"text-sm text-amber-600 hover:text-amber-500 dark:text-amber-400"},{default:m(()=>[...e[3]||(e[3]=[V(" ← К списку новостей ",-1)])]),_:1},8,["href"]),t.post?(o(),s(B,{key:0},[n("time",_,L(t.post.date),1),n("h1",A,L(t.post.title),1),t.post.image?(o(),s("img",{key:0,src:t.post.image,alt:t.post.title,loading:"lazy",class:"mt-4 w-full rounded-lg object-cover"},null,8,G)):l("",!0),n("div",{class:"mt-6 prose prose-lg prose-gray dark:prose-invert dark:prose-headings:text-white prose-p:text-gray-700 dark:prose-p:text-gray-300 prose-a:text-amber-600 dark:prose-a:text-amber-400 prose-img:rounded-lg max-w-none",innerHTML:t.post.body??""},null,8,J),(y=t.post.images)!=null&&y.length?(o(),s("section",K,[e[4]||(e[4]=n("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},"Фото",-1)),n("div",O,[(o(!0),s(B,null,z(t.post.images,(r,d)=>(o(),s("button",{key:d,type:"button",class:"aspect-square overflow-hidden rounded-lg bg-gray-100 dark:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-amber-500",onClick:u=>c.value=r},[n("img",{src:r,alt:`${t.post.title} — фото ${d+1}`,class:"h-full w-full object-cover",loading:"lazy"},null,8,W)],8,Q))),128))])])):l("",!0),t.post.video_url?(o(),s("section",X,[e[5]||(e[5]=n("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},"Видео",-1)),n("div",Y,[g(t.post.video_url)?(o(),s("iframe",{key:0,src:g(t.post.video_url),title:"Видео",class:"h-full w-full",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""},null,8,Z)):l("",!0)])])):t.post.video_file?(o(),s("section",tt,[e[6]||(e[6]=n("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},"Видео",-1)),n("div",et,[n("video",{controls:"",class:"w-full",src:t.post.video_file}," Ваш браузер не поддерживает воспроизведение видео. ",8,ot)])])):l("",!0),(o(),w(M,{to:"body"},[c.value?(o(),s("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/90 p-4",onClick:e[1]||(e[1]=R(r=>c.value=null,["self"]))},[n("button",{type:"button",class:"absolute right-4 top-4 text-white hover:text-gray-300","aria-label":"Закрыть",onClick:e[0]||(e[0]=r=>c.value=null)}," ✕ "),n("img",{src:c.value,alt:"Фото",class:"max-h-full max-w-full object-contain"},null,8,st)])):l("",!0)]))],64)):(o(),s("p",nt,"Публикация не найдена или ещё не загружена."))])]}),_:1},8,["can-login","can-register"]))}});export{it as default};
